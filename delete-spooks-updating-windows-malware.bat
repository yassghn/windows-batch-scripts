@echo OFF

REM windows 10
REM slaughter all spooks forever
REM replace text <SID_HERE> with your admin sid

takeown /F C:\windows\system32\UpdateAgent.dll
takeown /F C:\windows\system32\updatecsp.dll
takeown /F C:\windows\system32\UpdateDeploymentProvider.dll
takeown /F C:\windows\system32\updateHeartbeat.dll
takeown /F C:\windows\system32\updatepolicy.dll
takeown /F C:\windows\system32\wuaueng.dll
takeown /F C:\windows\system32\wuauclt.exe
takeown /F C:\windows\system32\wudriver.dll
takeown /F C:\windows\system32\wups.dll
takeown /F C:\windows\system32\wups2.dll
takeown /F C:\windows\system32\wusa.exe
takeown /F C:\windows\system32\wuuhext.dll
takeown /F C:\windows\system32\wuuhosdeployment.dll
takeown /F C:\windows\system32\WaaSAssessment.dll
takeown /F C:\windows\system32\WaaSMedicAgent.exe
takeown /F C:\windows\system32\WaaSMedicCapsule.dll
takeown /F C:\windows\system32\WaaSMedicPS.dll
takeown /F C:\windows\system32\WaaSMedicSvc.dll

icacls C:\windows\system32\UpdateAgent.dll /grant <SID_HERE>:f
icacls C:\windows\system32\updatecsp.dll /grant <SID_HERE>:f
icacls C:\windows\system32\UpdateDeploymentProvider.dll /grant <SID_HERE>:f
icacls C:\windows\system32\updateHeartbeat.dll /grant <SID_HERE>:f
icacls C:\windows\system32\updatepolicy.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wuaueng.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wuauclt.exe /grant <SID_HERE>:f
icacls C:\windows\system32\wudriver.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wups.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wups2.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wusa.exe /grant <SID_HERE>:f
icacls C:\windows\system32\wuuhext.dll /grant <SID_HERE>:f
icacls C:\windows\system32\wuuhosdeployment.dll /grant <SID_HERE>:f
icacls C:\windows\system32\WaaSAssessment.dll /grant <SID_HERE>:f
icacls C:\windows\system32\WaaSMedicAgent.exe /grant <SID_HERE>:f
icacls C:\windows\system32\WaaSMedicCapsule.dll /grant <SID_HERE>:f
icacls C:\windows\system32\WaaSMedicPS.dll /grant <SID_HERE>:f
icacls C:\windows\system32\WaaSMedicSvc.dll /grant <SID_HERE>:f


del /f C:\windows\system32\UpdateAgent.dll
del /f C:\windows\system32\updatecsp.dll
del /f C:\windows\system32\UpdateDeploymentProvider.dll
del /f C:\windows\system32\updateHeartbeat.dll
del /f C:\windows\system32\updatepolicy.dll
del /f C:\windows\system32\wuaueng.dll
del /f C:\windows\system32\wuauclt.exe
del /f C:\windows\system32\wudriver.dll
del /f C:\windows\system32\wups.dll
del /f C:\windows\system32\wups2.dll
del /f C:\windows\system32\wusa.exe
del /f C:\windows\system32\wuuhext.dll
del /f C:\windows\system32\wuuhosdeployment.dll
del /f C:\windows\system32\WaaSAssessment.dll
del /f C:\windows\system32\WaaSMedicAgent.exe
del /f C:\windows\system32\WaaSMedicCapsule.dll
del /f C:\windows\system32\WaaSMedicPS.dll
del /f C:\windows\system32\WaaSMedicSvc.dll

sc delete wuauserv
sc delete UsoSvc

REM access denied?
REM kill every single msft engineer
REM HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WaaSMedicSvc
sc delete WaaSmedicSvc

:end
pause